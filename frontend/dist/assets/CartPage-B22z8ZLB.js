import{y as x,b as p,d as c,x as d,j as e}from"./index-BOTlMoAj.js";import{d as j}from"./mappers-CIFgCg7B.js";import{S as r}from"./skeleton-B4YvRN7w.js";import{E as h}from"./empty-CguYNUJV.js";function g(){const i=x(),{data:a,isLoading:n,isError:l}=p({queryKey:["cart"],queryFn:async()=>{const{data:s}=await c.get("/cart/");return j(s)}}),m=d({mutationFn:async({id:s,amount:t})=>c.patch(`/cart/${s}/`,{amount:t,...a!=null&&a.cart_id?{cart_id:a.cart_id}:{}}),onSuccess:()=>i.invalidateQueries({queryKey:["cart"]})}),o=d({mutationFn:async s=>c.delete(`/cart/${s}/`,{params:a!=null&&a.cart_id?{cart_id:a.cart_id}:void 0}),onSuccess:()=>i.invalidateQueries({queryKey:["cart"]})}),u=d({mutationFn:async()=>c.delete("/cart/clear/",{params:a!=null&&a.cart_id?{cart_id:a.cart_id}:void 0}),onSuccess:()=>i.invalidateQueries({queryKey:["cart"]})});return n?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Donation Cart"}),e.jsx("div",{className:"rounded-lg border divide-y",children:Array.from({length:3}).map((s,t)=>e.jsxs("div",{className:"p-4 flex items-center gap-4",children:[e.jsx(r,{className:"w-16 h-16 rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(r,{className:"h-4 w-48"}),e.jsx(r,{className:"h-3 w-24 mt-2"}),e.jsx(r,{className:"h-8 w-32 mt-3"})]}),e.jsx(r,{className:"h-8 w-20"})]},t))})]}):l||!a?e.jsx("div",{className:"text-red-600",children:"Failed to load cart."}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Donation Cart"}),a.items.length===0?e.jsx(h,{title:"Your cart is empty",description:"Add donations to your cart from a cause page."}):e.jsx("div",{className:"rounded-lg border divide-y",children:a.items.map(s=>e.jsxs("div",{className:"p-4 flex items-center gap-4",children:[s.cause.featured_image&&e.jsx("img",{src:s.cause.featured_image,alt:"",className:"w-16 h-16 rounded object-cover"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:s.cause.title}),e.jsx("div",{className:"text-sm text-slate-500",children:"Amount (GHS)"}),e.jsx("input",{type:"number",min:1,defaultValue:s.amount,onBlur:t=>m.mutate({id:s.id,amount:Number(t.target.value)}),className:"mt-1 w-32 rounded-md border px-2 py-1"})]}),e.jsx("button",{onClick:()=>o.mutate(s.id),className:"px-3 py-2 rounded-md border",children:"Remove"})]},s.id))}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-slate-600",children:["Items: ",a.item_count]}),e.jsxs("div",{className:"text-lg font-medium",children:["Total: â‚µ",a.total_amount.toFixed(2)]})]}),e.jsx("div",{className:"flex gap-3",children:e.jsx("button",{onClick:()=>u.mutate(),className:"px-4 py-2 rounded-md border",children:"Clear Cart"})})]})}export{g as CartPage};
