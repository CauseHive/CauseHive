import{u as N,s as w,r as n,b as S,d as g,x as F,j as a}from"./index-BOTlMoAj.js";import{B as k}from"./button-BQgy-EYF.js";function R(){const{notify:u}=N(),h=w(),[l,f]=n.useState(""),[o,b]=n.useState(""),[r,v]=n.useState(""),[c,j]=n.useState(""),m=n.useRef(null),[p,x]=n.useState(!1),{data:d}=S({queryKey:["categories-basic"],queryFn:async()=>{var e;return((e=(await g.get("/categories/")).data)==null?void 0:e.results)||[]}}),y=F({mutationFn:async()=>{var t,i;const e=new FormData;e.append("name",l),o&&e.append("description",o),r&&e.append("target_amount",r),c&&e.append("category",c);const s=(i=(t=m.current)==null?void 0:t.files)==null?void 0:i[0];return s&&e.append("cover_image",s),x(!0),g.post("/causes/create/",e,{headers:{"Content-Type":"multipart/form-data"}})},onSuccess:e=>{var t;u({title:"Cause submitted",description:"Awaiting review",variant:"success"});const s=(t=e.data)==null?void 0:t.id;s&&h(`/causes/${s}`)},onError:e=>{var t,i;const s=((i=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:i.error)||"Failed to create cause";u({title:"Create failed",description:s,variant:"error"})},onSettled:()=>x(!1)}),C=!l||!r;return a.jsxs("div",{className:"max-w-2xl space-y-6",children:[a.jsx("h1",{className:"text-2xl font-semibold",children:"Create a Cause"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1",htmlFor:"name",children:"Title"}),a.jsx("input",{id:"name",value:l,onChange:e=>f(e.target.value),className:"w-full rounded-md border px-3 py-2",placeholder:"Cause title"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1",htmlFor:"description",children:"Description"}),a.jsx("textarea",{id:"description",value:o,onChange:e=>b(e.target.value),className:"w-full h-40 rounded-md border px-3 py-2 resize-none",placeholder:"Explain the purpose and impact"})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"md:col-span-1",children:[a.jsx("label",{className:"block text-xs mb-1",htmlFor:"target_amount",children:"Target Amount"}),a.jsx("input",{id:"target_amount",type:"number",min:"0",value:r,onChange:e=>v(e.target.value),className:"w-full rounded-md border px-3 py-2"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-xs mb-1",htmlFor:"category",children:"Category"}),a.jsxs("select",{id:"category",value:c,onChange:e=>j(e.target.value),className:"w-full rounded-md border px-3 py-2",children:[a.jsx("option",{value:"",children:"Select category (optional)"}),d==null?void 0:d.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs mb-1",children:"Cover Image"}),a.jsx("input",{ref:m,type:"file",accept:"image/*"})]}),a.jsx(k,{disabled:C||p,onClick:()=>y.mutate(),className:"w-full",children:p?"Creatingâ€¦":"Submit for Review"})]})]})}export{R as default};
