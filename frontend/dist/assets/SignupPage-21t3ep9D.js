import{s as N,u as y,r as v,t as _,j as s,L as S,d as h,v as k}from"./index-BOTlMoAj.js";import{u as F,t as E,o as C,s as l}from"./zod-CKyyCNA0.js";const A=C({first_name:l().trim().min(1,"First name is required"),last_name:l().trim().min(1,"Last name is required"),email:l().trim().email("Enter a valid email"),password:l().min(8,"Password must be at least 8 characters"),password2:l().min(8,"Confirm password must be at least 8 characters")}).refine(a=>a.password===a.password2,{path:["password2"],message:"Passwords must match"});function T(){const a=N(),{notify:d}=y(),{register:t,handleSubmit:g,formState:{errors:e,isSubmitting:c},setError:b,clearErrors:w}=F({resolver:E(A)});v.useEffect(()=>{_.getAccessToken()&&a("/app",{replace:!0})},[a]);const f=async o=>{var p;w();try{await h.post("/user/auth/signup/",o);const{data:r}=await h.post("/user/auth/login/",{email:o.email,password:o.password});k({access:r.access,refresh:r.refresh,user:r.user,navigate:a,notify:d,welcomeTitle:"Welcome to CauseHive",welcomeDescription:"Your account is ready."})}catch(r){const x=r,i=(p=x.response)==null?void 0:p.data;if(i&&typeof i=="object"){const j=["first_name","last_name","email","password","password2"];let u=!1;for(const m of j){const n=i[m];Array.isArray(n)&&n.length&&(u=!0,b(m,{type:"server",message:String(n[0])}))}if(!u){const m=i.error||i.detail||"Signup failed";d({title:"Signup failed",description:String(m),variant:"error"})}}else d({title:"Signup failed",description:x.message||"Please try again.",variant:"error"})}};return s.jsxs("div",{className:"max-w-md mx-auto",children:[s.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Create account"}),s.jsxs("form",{onSubmit:g(f),className:"space-y-4",noValidate:!0,children:[s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm mb-1",htmlFor:"first_name",children:"First name"}),s.jsx("input",{id:"first_name",className:"w-full rounded-md border px-3 py-2 bg-white dark:bg-slate-900",...t("first_name")}),e.first_name&&s.jsx("p",{className:"text-xs text-red-600 mt-1",children:e.first_name.message})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm mb-1",htmlFor:"last_name",children:"Last name"}),s.jsx("input",{id:"last_name",className:"w-full rounded-md border px-3 py-2 bg-white dark:bg-slate-900",...t("last_name")}),e.last_name&&s.jsx("p",{className:"text-xs text-red-600 mt-1",children:e.last_name.message})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm mb-1",htmlFor:"email",children:"Email"}),s.jsx("input",{id:"email",type:"email",className:"w-full rounded-md border px-3 py-2 bg-white dark:bg-slate-900",...t("email")}),e.email&&s.jsx("p",{className:"text-xs text-red-600 mt-1",children:e.email.message})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm mb-1",htmlFor:"password",children:"Password"}),s.jsx("input",{id:"password",type:"password",className:"w-full rounded-md border px-3 py-2 bg-white dark:bg-slate-900",...t("password")}),e.password&&s.jsx("p",{className:"text-xs text-red-600 mt-1",children:e.password.message})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm mb-1",htmlFor:"password2",children:"Confirm password"}),s.jsx("input",{id:"password2",type:"password",className:"w-full rounded-md border px-3 py-2 bg-white dark:bg-slate-900",...t("password2")}),e.password2&&s.jsx("p",{className:"text-xs text-red-600 mt-1",children:e.password2.message})]})]}),s.jsx("button",{disabled:c,className:"w-full rounded-md bg-emerald-600 text-white py-2 hover:bg-emerald-700 disabled:opacity-60",children:c?"Creatingâ€¦":"Create account"})]}),s.jsxs("p",{className:"text-sm mt-4",children:["Have an account? ",s.jsx(S,{to:"/login",className:"text-emerald-700",children:"Sign in"})]})]})}export{T as SignupPage};
