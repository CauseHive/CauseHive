import{r as i,j as a,c as d,u as S,a as P,b as j,L as y,d as N}from"./index-BOTlMoAj.js";import{m as L,a as R,b as k}from"./mappers-CIFgCg7B.js";import{S as c}from"./skeleton-B4YvRN7w.js";import{B as _}from"./button-BQgy-EYF.js";import{B as $}from"./badge-Dnd58h3w.js";import{P as q}from"./pagination-ClcPKFUW.js";import{E}from"./empty-CguYNUJV.js";const b=i.forwardRef(({className:t,...s},r)=>a.jsx("div",{ref:r,className:d("rounded-lg border bg-white text-slate-900 dark:bg-slate-900 dark:text-slate-100",t),...s}));b.displayName="Card";const F=i.forwardRef(({className:t,...s},r)=>a.jsx("div",{ref:r,className:d("p-4 pb-0",t),...s}));F.displayName="CardHeader";const T=i.forwardRef(({className:t,...s},r)=>a.jsx("h3",{ref:r,className:d("text-lg font-semibold",t),...s}));T.displayName="CardTitle";const A=i.forwardRef(({className:t,...s},r)=>a.jsx("p",{ref:r,className:d("text-sm text-slate-600 dark:text-slate-300",t),...s}));A.displayName="CardDescription";const w=i.forwardRef(({className:t,...s},r)=>a.jsx("div",{ref:r,className:d("p-4",t),...s}));w.displayName="CardContent";const D=i.forwardRef(({className:t,...s},r)=>a.jsx("div",{ref:r,className:d("p-4 pt-0",t),...s}));D.displayName="CardFooter";function U({value:t,className:s}){const r=Math.max(0,Math.min(100,t));return a.jsx("div",{className:d("h-2 w-full overflow-hidden rounded-full bg-slate-200 dark:bg-slate-800",s),role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":r,children:a.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${r}%`}})})}function Q(){const{notify:t}=S(),[s,r]=P(),n=Number(s.get("page")??"1"),p=s.get("search")??"",m=s.get("category")??"",{data:x,isLoading:v}=j({queryKey:["categories"],queryFn:async()=>{const{data:e}=await N.get("/categories/");return Array.isArray(e==null?void 0:e.results)?e.results.map(L):[]}}),{data:o,isLoading:u,isError:h}=j({queryKey:["causes",{page:n,search:p,category:m}],queryFn:async()=>{const{data:e}=await N.get("/causes/",{params:{page:n,search:p||void 0,category:m||void 0,status:"live",ordering:"-created_at"}});return R(e,k)}}),C=e=>{e.preventDefault();const l=new FormData(e.currentTarget),f=String(l.get("q")??""),g=new URLSearchParams(s);f?g.set("search",f):g.delete("search"),g.set("page","1"),r(g)};return i.useEffect(()=>{h&&t({title:"Failed to load causes",variant:"error"})},[h,t]),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between gap-4",children:[a.jsx("h1",{className:"text-2xl font-semibold",children:"Discover Causes"}),a.jsxs("form",{onSubmit:C,className:"flex gap-2",children:[a.jsx("input",{name:"q",defaultValue:p,placeholder:"Search causes",className:"rounded-md border px-3 py-2 w-64 bg-white dark:bg-slate-900"}),a.jsx(_,{type:"submit",children:"Search"})]})]}),a.jsxs("div",{className:"flex gap-3 overflow-x-auto",children:[a.jsx("button",{onClick:()=>{const e=new URLSearchParams(s);e.delete("category"),e.set("page","1"),r(e)},className:`px-3 py-1 rounded-full border ${m?"border-slate-300":"bg-emerald-600 text-white border-emerald-600"}`,children:"All"}),v&&Array.from({length:6}).map((e,l)=>a.jsx(c,{className:"h-8 w-24 rounded-full"},l)),x==null?void 0:x.map(e=>a.jsx("button",{onClick:()=>{const l=new URLSearchParams(s);l.set("category",String(e.id)),l.set("page","1"),r(l)},className:`px-3 py-1 rounded-full border ${String(e.id)===m?"bg-emerald-600 text-white border-emerald-600":"border-slate-300"}`,children:e.name},e.id))]}),u&&a.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:Array.from({length:6}).map((e,l)=>a.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[a.jsx(c,{className:"h-44 w-full"}),a.jsx(c,{className:"h-4 w-32"}),a.jsx(c,{className:"h-6 w-3/4"}),a.jsx(c,{className:"h-2 w-full"})]},l))}),a.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[!u&&o&&o.results.length===0&&a.jsx("div",{className:"sm:col-span-2 lg:col-span-3",children:a.jsx(E,{title:"No causes found",description:"Try adjusting your search or category filters."})}),o==null?void 0:o.results.map(e=>a.jsxs(b,{children:[a.jsx(y,{to:`/causes/${e.id}`,children:e.featured_image&&a.jsx("img",{src:e.featured_image,alt:e.title?`Image for ${e.title}`:"Cause image",className:"w-full h-44 object-cover rounded-t-lg",loading:"lazy"})}),a.jsxs(w,{className:"space-y-2",children:[a.jsx($,{children:e.category.name}),a.jsx(y,{to:`/causes/${e.id}`,className:"block","aria-label":`Go to cause ${e.title}`,children:a.jsx("h3",{className:"font-medium line-clamp-2",children:e.title})}),a.jsxs("div",{className:"text-xs text-slate-500",children:["Target: â‚µ",e.target_amount.toLocaleString()]}),a.jsx(U,{value:e.progress_percentage})]})]},e.id))]}),o&&a.jsx(q,{page:n,hasPrev:!!o.previous,hasNext:!!o.next,onPrev:()=>{const e=new URLSearchParams(s);e.set("page",String(Math.max(1,n-1))),r(e)},onNext:()=>{const e=new URLSearchParams(s);e.set("page",String(n+1)),r(e)}})]})}export{Q as CausesPage};
